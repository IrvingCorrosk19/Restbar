@model RestBar.Models.Station

@{
    ViewData["Title"] = "Crear Estaci√≥n";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h3 class="card-title">Crear Nueva Estaci√≥n</h3>
                        <a asp-action="Index" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Volver
                        </a>
                    </div>
                </div>
                <div class="card-body">
                    <form asp-action="Create" method="post">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Name" class="control-label">Nombre de la Estaci√≥n</label>
                                    <input asp-for="Name" class="form-control" placeholder="Ej: Cocina Principal" />
                                    <span asp-validation-for="Name" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Type" class="control-label">Tipo de Estaci√≥n</label>
                                    <select asp-for="Type" class="form-select">
                                        <option value="">Seleccione un tipo...</option>
                                        <option value="Cocina">Cocina</option>
                                        <option value="Bar">Bar</option>
                                        <option value="Caf√©">Caf√©</option>
                                        <option value="Postres">Postres</option>
                                        <option value="Parrilla">Parrilla</option>
                                        <option value="Sushi">Sushi</option>
                                        <option value="Pizza">Pizza</option>
                                        <option value="Otro">Otro</option>
                                    </select>
                                    <span asp-validation-for="Type" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="AreaId" class="control-label">√Årea</label>
                                    <select asp-for="AreaId" asp-items="ViewBag.AreaId" class="form-select">
                                        <option value="">-- Seleccione un √°rea --</option>
                                    </select>
                                    <span asp-validation-for="AreaId" class="text-danger"></span>
                                    <div class="form-text">
                                        <i class="fas fa-info-circle"></i> 
                                        Opcional: Asigne la estaci√≥n a un √°rea espec√≠fica del restaurante
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Icon" class="control-label">√çcono</label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i id="icon-preview" class="fas fa-utensils"></i>
                                        </span>
                                        <select asp-for="Icon" class="form-select" id="icon-select">
                                            <option value="">-- Seleccione un √≠cono --</option>
                                            <option value="fa-utensils">üç¥ Utensils (Cocina)</option>
                                            <option value="fa-cocktail">üç∏ Cocktail (Bar)</option>
                                            <option value="fa-coffee">‚òï Coffee (Caf√©)</option>
                                            <option value="fa-fire">üî• Fire (Parrilla)</option>
                                            <option value="fa-pizza-slice">üçï Pizza</option>
                                            <option value="fa-cookie-bite">üç™ Cookie (Postres)</option>
                                            <option value="fa-fish">üêü Fish (Sushi)</option>
                                            <option value="fa-hamburger">üçî Hamburger</option>
                                            <option value="fa-ice-cream">üç¶ Ice Cream</option>
                                            <option value="fa-wine-glass">üç∑ Wine Glass</option>
                                            <option value="fa-beer">üç∫ Beer</option>
                                            <option value="fa-mortar-pestle">üß™ Mortar (Especial)</option>
                                        </select>
                                    </div>
                                    <span asp-validation-for="Icon" class="text-danger"></span>
                                    <div class="form-text">
                                        <i class="fas fa-info-circle"></i> 
                                        Opcional: √çcono para identificar visualmente la estaci√≥n
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group mb-3">
                                    <div class="form-check form-switch">
                                        <input asp-for="IsActive" class="form-check-input" type="checkbox" checked />
                                        <label asp-for="IsActive" class="form-check-label">
                                            <i class="fas fa-toggle-on text-success"></i> 
                                            Estaci√≥n Activa
                                        </label>
                                        <span asp-validation-for="IsActive" class="text-danger"></span>
                                    </div>
                                    <div class="form-text">
                                        <i class="fas fa-info-circle"></i> 
                                        Las estaciones inactivas no aparecer√°n disponibles para asignar productos
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Crear Estaci√≥n
                            </button>
                            <a asp-action="Index" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancelar
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        $(document).ready(function () {
            // Auto-completar el campo de tipo si se selecciona "Otro"
            $('#Type').on('change', function() {
                if ($(this).val() === 'Otro') {
                    var customType = prompt('Ingrese el tipo de estaci√≥n:');
                    if (customType && customType.trim() !== '') {
                        $(this).append(new Option(customType, customType, true, true));
                    } else {
                        $(this).val('');
                    }
                }
            });

            // Actualizar preview del √≠cono seleccionado
            $('#icon-select').on('change', function() {
                var selectedIcon = $(this).val();
                var iconPreview = $('#icon-preview');
                
                if (selectedIcon) {
                    iconPreview.removeClass().addClass('fas ' + selectedIcon);
                } else {
                    iconPreview.removeClass().addClass('fas fa-utensils');
                }
            });

            // Toggle visual para el checkbox IsActive
            $('input[name="IsActive"]').on('change', function() {
                var label = $(this).next('label');
                var icon = label.find('i');
                
                if ($(this).is(':checked')) {
                    icon.removeClass('fa-toggle-off text-danger').addClass('fa-toggle-on text-success');
                    label.contents().filter(function() {
                        return this.nodeType === 3; // Text nodes
                    }).first().replaceWith(' Estaci√≥n Activa');
                } else {
                    icon.removeClass('fa-toggle-on text-success').addClass('fa-toggle-off text-danger');
                    label.contents().filter(function() {
                        return this.nodeType === 3; // Text nodes
                    }).first().replaceWith(' Estaci√≥n Inactiva');
                }
            });

            // Inicializar estado del toggle
            $('input[name="IsActive"]').trigger('change');
        });
    </script>
} 