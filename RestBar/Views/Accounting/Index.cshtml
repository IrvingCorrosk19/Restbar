@{
    ViewData["Title"] = "Contabilidad - RestBar";
}

<div class="accounting-container">
    <div class="container-fluid">
        <!-- Header -->
        <div class="section-header">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1><i class="fas fa-calculator"></i> Contabilidad</h1>
                    <p class="text-muted">Gestión financiera y contable del restaurante</p>
                </div>
                <div class="col-md-6 text-end">
                    <div class="header-actions">
                        <button class="btn btn-primary" id="generateReport">
                            <i class="fas fa-file-invoice-dollar"></i> Generar Reporte
                        </button>
                        <button class="btn btn-success" id="exportData">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Stats -->
        <div class="row g-4 mb-4">
            <div class="col-lg-3 col-md-6">
                <div class="stat-card stat-income">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalIncome">$0.00</h3>
                        <p>Ingresos Totales</p>
                        <small class="text-success">+12.5% vs mes anterior</small>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card stat-expenses">
                    <div class="stat-icon">
                        <i class="fas fa-receipt"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalExpenses">$0.00</h3>
                        <p>Gastos Totales</p>
                        <small class="text-danger">+8.2% vs mes anterior</small>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card stat-profit">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="netProfit">$0.00</h3>
                        <p>Beneficio Neto</p>
                        <small class="text-success">+15.3% vs mes anterior</small>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card stat-taxes">
                    <div class="stat-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalTaxes">$0.00</h3>
                        <p>Impuestos</p>
                        <small class="text-info">Actualizado hoy</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="row g-4">
            <!-- Financial Summary -->
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-chart-area"></i> Resumen Financiero</h5>
                        <div class="card-actions">
                            <select class="form-select form-select-sm" id="periodFilter">
                                <option value="month">Este Mes</option>
                                <option value="quarter">Este Trimestre</option>
                                <option value="year">Este Año</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="financialChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-bolt"></i> Acciones Rápidas</h5>
                    </div>
                    <div class="card-body">
                        <div class="quick-actions">
                            <button class="btn btn-outline-primary w-100 mb-2" id="viewIncome">
                                <i class="fas fa-dollar-sign"></i> Ver Ingresos
                            </button>
                            <button class="btn btn-outline-warning w-100 mb-2" id="viewExpenses">
                                <i class="fas fa-receipt"></i> Ver Gastos
                            </button>
                            <button class="btn btn-outline-success w-100 mb-2" id="viewProfit">
                                <i class="fas fa-chart-line"></i> Ver Beneficios
                            </button>
                            <button class="btn btn-outline-info w-100 mb-2" id="viewTaxes">
                                <i class="fas fa-percentage"></i> Ver Impuestos
                            </button>
                            <button class="btn btn-outline-secondary w-100 mb-2" id="viewReports">
                                <i class="fas fa-file-alt"></i> Reportes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Tables -->
        <div class="row g-4 mt-4">
            <!-- Income Details -->
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-dollar-sign"></i> Detalle de Ingresos</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="incomeTable">
                                <thead>
                                    <tr>
                                        <th>Concepto</th>
                                        <th>Monto</th>
                                        <th>Fecha</th>
                                        <th>Estado</th>
                                    </tr>
                                </thead>
                                <tbody id="incomeTableBody">
                                    <!-- Data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="text-center" id="incomeLoading">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Expense Details -->
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-receipt"></i> Detalle de Gastos</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="expenseTable">
                                <thead>
                                    <tr>
                                        <th>Concepto</th>
                                        <th>Monto</th>
                                        <th>Fecha</th>
                                        <th>Categoría</th>
                                    </tr>
                                </thead>
                                <tbody id="expenseTableBody">
                                    <!-- Data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="text-center" id="expenseLoading">
                            <div class="spinner-border text-warning" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tax Summary -->
        <div class="row g-4 mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-percentage"></i> Resumen de Impuestos</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="tax-item">
                                    <h6>IVA Cobrado</h6>
                                    <h4 class="text-success" id="ivaCollected">$0.00</h4>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="tax-item">
                                    <h6>IVA Pagado</h6>
                                    <h4 class="text-warning" id="ivaPaid">$0.00</h4>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="tax-item">
                                    <h6>IVA a Pagar</h6>
                                    <h4 class="text-info" id="ivaToPay">$0.00</h4>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="tax-item">
                                    <h6>ISR</h6>
                                    <h4 class="text-danger" id="isr">$0.00</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Report Modal -->
<div class="modal fade" id="reportModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-file-invoice-dollar"></i>
                    Generar Reporte Contable
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Tipo de Reporte</label>
                            <select class="form-select" id="reportType">
                                <option value="income">Reporte de Ingresos</option>
                                <option value="expenses">Reporte de Gastos</option>
                                <option value="profit">Reporte de Beneficios</option>
                                <option value="taxes">Reporte de Impuestos</option>
                                <option value="comprehensive">Reporte Integral</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Período</label>
                            <select class="form-select" id="reportPeriod">
                                <option value="current_month">Mes Actual</option>
                                <option value="last_month">Mes Anterior</option>
                                <option value="current_quarter">Trimestre Actual</option>
                                <option value="current_year">Año Actual</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row" id="customDateRange" style="display: none;">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Fecha Inicio</label>
                            <input type="date" class="form-control" id="startDate">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Fecha Fin</label>
                            <input type="date" class="form-control" id="endDate">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="generateReportBtn">
                    <i class="fas fa-download"></i> Generar Reporte
                </button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="~/js/accounting.js"></script>
}

@section Styles {
    <link rel="stylesheet" href="~/css/accounting.css" />
} 